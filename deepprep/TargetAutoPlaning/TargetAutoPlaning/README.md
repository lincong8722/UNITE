这里的基础代码被ssli做了一些修改，和weiwei之前的代码相比进行了改进，改进函数如下：
1. compute_surf_FC